Crèmes <- read.table("http://www.agrocampus-ouest.fr/math/husson/StatUtilisateurExo/chap14_ex9.csv", header = TRUE, sep=";",row.names=1)

X <- model.matrix(~ Text1 + Text2 + I(Text1^2) + I(Text2^2) + I(Text1*Text2), Crèmes)
round(X,3)
round(cor(X),3)

## Avec toutes les interactions :
summary(lm(Visc.t0 ~ Text1 + Text2 + I(Text1^2) + I(Text2^2) + I(Text1*Text2), data = Crèmes))

TabCoeff <- TabProba <- matrix(NA,6,6)
for (i in 1:6){
  res <- summary(lm(Crèmes[,i+2] ~ Text1 + Text2 + I(Text1^2) + I(Text2^2) + I(Text1*Text2), data = Crèmes))
  TabProba[,i] <- res$coeff[,4]
  TabCoeff[,i] <- res$coeff[,1]
}
round(TabProba,3)
round(TabCoeff,3)

par(mfrow=c(1,2))
plot(Visc.t0 ~ Text1, xlab="Texturant 1", ylab="Viscosité à t0", data=Crèmes,pch=20)
text(Crèmes[,c(1,3)],rownames(Crèmes),pos=4)
plot(Visc.t60 ~ Text2, xlab="Texturant 1", ylab="Viscosité à t60", data=Crèmes,pch=20)
text(Crèmes[,c(1,6)],rownames(Crèmes),pos=4)

par(mfrow=c(1,2))
plot(Visc.t0 ~ Text2, xlab="Texturant 2", ylab="Viscosité à t0", data=Crèmes,pch=20)
text(Crèmes[,c(2,3)],rownames(Crèmes),pos=4)
plot(Visc.t60 ~ Text2, xlab="Texturant 2", ylab="Viscosité à t60", data=Crèmes,pch=20)
text(Crèmes[,c(2,6)],rownames(Crèmes),pos=4)
